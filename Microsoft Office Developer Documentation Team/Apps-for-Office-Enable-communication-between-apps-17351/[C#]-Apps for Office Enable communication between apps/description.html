<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
    <head><link rel="stylesheet" type="text/css" href="description/Combined.css,0:HeaderFooterSprite,0:Header.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=C9973DA951AE6202C9B348379A1BE49D" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />
<link rel="stylesheet" type="text/css" href="description/04f9c26e-88fd-4dfd-b715-9733d17420b6Combined.css,0:HeaderFooterSprite,0:Footer.NonMtps,1:LinkList;/Areas/Centers/Themes/StandardDevCenter/Content:0,/Areas/Epx/Themes/Base/Content:1&amp;amp;hashKey=F576C687BC536B84D6E5B3246EE39B49" xmlns="http://www.w3.org/1999/xhtml" />
<link type="text/css" rel="stylesheet" xmlns="http://www.w3.org/1999/xhtml" />

        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <title>Apps for Office: Enable communication between apps</title>
        <link href="description/Galleries.css" type="text/css" rel="Stylesheet" /><link href="description/Layout.css" type="text/css" rel="Stylesheet" /><link href="description/Brand.css" type="text/css" rel="Stylesheet" />
        <link href="description/iframedescription.css" rel="Stylesheet" type="text/css" />
        <script src="description/offline.js" type="text/javascript"></script>
        <style type="text/css">
            #projectInfo {
                overflow: auto;
            }
            #longDesc {
                clear:both;
                margin: 25px 0 10px 0;
            }

            #SampleIndexList{
                margin-left: 15px;
            }
        </style>
    </head>
<body>
    <div id="offlineDescription">
        <h1>Apps for Office: Enable communication between apps</h1>
        <br/>
        <div id="projectInfo">
            <div class="section">
                    <div class="itemBarLong tagsContainer">
                        <label for="Technologies">Technologies</label>
                        <div id="Technologies">
                            Excel 2013, apps for Office
                        </div>
                    </div>
                    <div class="itemBarLong tagsContainer">
                        <label for="Topics">Topics</label>
                        <div id="Topics">
                            data and storage
                        </div>
                    </div>
                <div class="itemBarLong">
                    <label for="Platforms">Platforms</label>
                    <div id="Platforms">
                        Desktop, Web, Cloud, Data
                    </div>
                </div>
                <div class="itemBarLong">
                    <label for="Requirements">Requirements</label>
                    <div id="Requirements">
                        
                    </div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Primary language</label>
                    <div id="LastUpdated">en-US</div>
                </div>
                <div class="itemBar">
                    <label for="LastUpdated">Updated</label>
                    <div id="LastUpdated">3/8/2013</div>
                </div>
                <div class="itemBarLong">
                    <label for="License">License</label>
                    <div id="License">
                        <a href="license.rtf">Apache License, Version 2.0</a></div>
                </div>
                <div class="itemBar">
                    <div class="viewonlinecont">
                        <a data-link="online" href="http://code.msdn.microsoft.com/Apps-for-Office-Enable-46024745">View this sample online</a>
                    </div>
                </div>
            </div>
        </div>
        
                   
<script type="text/javascript">
    function initializePage() {
        var otherTabClass = 'otherTab';
        var hiddenPreClass = 'hidden';

        var htmlDecode = function(encodedData) {
            var decodedData = "";
            if (encodedData) {
                var div = document.createElement('div');
                div.innerHTML = encodedData;
                decodedData = div.firstChild.nodeValue.replace( /\\r\\n/ig , '\r\n');
            }
            return decodedData;
        };
                
        Galleries.iterateElem(Galleries.findElem(null, 'div', 'scriptcode'), function (index, scriptBlock) {
            var titleElem = Galleries.findElem(scriptBlock, 'div', 'title')[0];
            var labelElems = Galleries.findElem(titleElem, 'span');
            if (labelElems.length == 0) {
                labelElems = titleElem;
            }
            var languageSpans = Galleries.findElem(scriptBlock, 'span', 'hidden');
            var pres = Galleries.findElem(scriptBlock, 'pre');
            if (languageSpans.length > 0 && pres.length > 1) {
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    var languageSpan = languageSpans[index];
                            
                    elem.code = codePre.innerHTML.replace( /(\r(\n)?)|((\r)?\n)/ig , '\\r\\n');
                            
                    codePre.className = codePre.className.replace(hiddenPreClass, '');
                            
                    languageSpan.parentNode.removeChild(languageSpan);
                });

                pres = Galleries.findElem(scriptBlock, 'pre');
                Galleries.iterateElem(labelElems, function(index, elem) {
                    var codePre = pres[index];
                    var labelSpan = elem;
                    if (index == 0) {
                        scriptBlock.activeTab = 0;
                    }
                    else {
                        labelSpan.className += otherTabClass;
                        codePre.className += hiddenPreClass;
                    }
                    Galleries.attachEventHandler(labelSpan, 'click', function(e) {
                        var activeTab = scriptBlock.activeTab;
                        labelElems[activeTab].className += otherTabClass;
                        pres[activeTab].className += hiddenPreClass;

                        codePre.className = codePre.className.replace(hiddenPreClass, '');
                        labelSpan.className = labelSpan.className.replace(otherTabClass, '');
                        scriptBlock.activeTab = index;
                    });
                });

                var preview = Galleries.findElem(scriptBlock, 'div', 'preview');
                if (preview.length == 0) {
                    preview.push(pres[pres.length - 1]);
                }
                Galleries.iterateElem(preview, function(index, elem) {
                    elem.parentNode.removeChild(elem);
                });

                if (window.clipboardData && clipboardData.setData) {
                    var copyLink = document.createElement('a');
                    copyLink.href = 'javascript:void(0);';
                    copyLink.className = 'copyCode';
                    copyLink.innerHTML = 'Copy code';
                    Galleries.attachEventHandler(copyLink, 'click', function (e) {
                        clipboardData.setData("Text", htmlDecode(labelElems[scriptBlock.activeTab].code));
                        return false;
                    });
                    scriptBlock.insertBefore(copyLink, scriptBlock.childNodes[0]);
                }
            }
        });
    }

    Galleries.onWindowLoad(function(){
        initializePage();
    });

</script>
<div id="longDesc">
    
<p><span style="font-size:small">The code in the task pane app for Excel demonstrates how to build a simple user interface that saves data to cross-session web browser storage (localStorage). It also shows how to use a dynamically generated div to surface errors
 to the user.</span></p>
<p><span style="font-size:small">The code in the content app for Excel demonstrates how to detect when the selection in the spreadsheet changes, how to get the data selected after that event, and how to monitor the shared data source for changes. It captures
 the data from the spreadsheet in an array, evaluates the spreadsheet data with the data from the task pane app, and then displays the results in a table.</span></p>
<p><span style="font-size:small"><img id="59998" src="description/AppsForOffice1a.png" alt="" width="645" height="382">&nbsp;</span><br>
&nbsp;<br>
<span style="font-size:small">The content app also displays some best practices around how to use a dynamically-applied CSS to modify the behavior of the UI.</span></p>
<h1>Prerequisites</h1>
<p><span style="font-size:small">This sample requires the following:</span></p>
<ul>
<li><span style="font-size:small">Excel 2013.</span> </li><li><span style="font-size:small">Visual Studio 2012, apps for Office project templates.</span>
</li><li><span style="font-size:small">Internet Explorer 9 or Internet Explorer 10 Preview.</span>
</li><li><span style="font-size:small">Basic familiarity with JavaScript, CSS, jQuery, and HTML5.</span>
</li></ul>
<h1>Key components of the sample</h1>
<p><span style="font-size:small">The <em>Apps for Office: Enable communication between apps</em> sample app contains the following important files:</span></p>
<ul>
<li><span style="font-size:small">CodeSample_ConnectedApps project, including:</span>
<ul>
<li><span style="font-size:small">CodeSample_ConnectedApps.xml manifest</span> </li><li><span style="font-size:small">CodeSample_ConnectedApps.js file</span> </li><li><span style="font-size:small">CodeSample_ConnectedApps.html file</span> </li><li><span style="font-size:small">toast.js file</span> </li></ul>
</li><li><span style="font-size:small">CodeSample_ConsumerApp project, including:</span>
<ul>
<li><span style="font-size:small">CodeSample_ConsumerApp.xml manifest</span> </li><li><span style="font-size:small">CodeSample_ConsumerApp.js file</span> </li><li><span style="font-size:small">CodeSample_ConsumerApp.html file</span> </li><li><span style="font-size:small">MortgageCalculator.js file</span> </li><li><span style="font-size:small">App.css file</span> </li></ul>
</li></ul>
<h1>Configure the sample</h1>
<p><span style="font-size:small">No additional configuration is necessary to run the sample.</span></p>
<h1>Build the sample</h1>
<p><span style="font-size:small">Choose the F5 key to build and deploy the apps.</span></p>
<h1>Run and test the sample</h1>
<ol>
<li><span style="font-size:small">Choose the F5 key to build and deploy the apps.</span><br>
<span style="font-size:small">Two instances of Excel 2013 will open, one with the content app (&ldquo;Mortgage Calculator&rdquo;) displayed and the other with the task pane app (&ldquo;Mortgage Info App&rdquo;) displayed.</span>
</li><li><span style="font-size:small">In one of the two instances of Excel 2013, on the
<strong>Insert </strong>tab, in the <strong>Apps for Office</strong> group, choose the arrow below
<strong>App</strong>, and then choose the app that you want to insert.</span><br>
<span style="font-size:small">The other app will be inserted into the current instance of Excel. Both apps should now be inserted in the same Excel session.</span>
</li><li><span style="font-size:small">In the content app (&ldquo;Mortgage Calculator&rdquo;), choose
<strong>Connect to Data</strong> to establish a connection between the two apps (listening for changes in the data source).</span>
</li><li><span style="font-size:small">In the task pane app, enter numbers into the two text box inputs and select an option from the drop-down list. Choose the
<strong>Submit</strong> button when you have entered your data.</span> </li><li><span style="font-size:small">In the Excel spreadsheet, enter numbers into one or more rows in a single column. Select the rows singly or as a range in a single column.</span>
</li></ol>
<h1>Troubleshooting</h1>
<p><span style="font-size:small">If the app fails to install, ensure that the <strong>
SourceLocation</strong> element in the CodeSample_ConnectedApps.xml and CodeSample_ConsumerApp.xml files has the correct URL value for the DefaultValue attribute.</span></p>
<h1>Related content</h1>
<ul>
<li><span style="font-size:small"><a href="http://msdn.microsoft.com/en-us/library/cc197062(VS.85).aspx">Introduction to Web Storage</a></span>
</li><li><span style="font-size:small"><a href="http://msdn.microsoft.com/library/4cbc527c-a1d5-4fb0-b6db-28cc40c5d5e2">Document.SelectionChanged event</a></span>
</li><li><span style="font-size:small"><a href="http://msdn.microsoft.com/en-us/library/fp142294(v=office.15)">Document.getSelectedDataAsync method</a></span>
</li></ul>

</div>


    </div>
</body>
</html>
